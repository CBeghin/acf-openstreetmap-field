!function(s,a){var t=window.osm,n=t.Field;t.Field=n.extend({$lat:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-lat"]')},$lng:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-lng"]')},$zoom:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-zoom"]')},$returnFormat:function(){return this.$el.closest(".acf-field-settings").find('[data-name="return_format"]')},getMapData:function(){return{lat:parseFloat(this.$lat().val()||this.$el.data().mapLat),lng:parseFloat(this.$lng().val()||this.$el.data().mapLng),zoom:parseInt(this.$zoom().val()||this.$el.data().mapZoom),layers:this.$el.data().mapLayers}},initialize:function(t){n.prototype.initialize.apply(this,arguments),this.bindMapListener(),this.bindListener()},updateInput:function(){this.$lat().val(this.model.get("lat")),this.$lng().val(this.model.get("lng")),this.$zoom().val(this.model.get("zoom"))},initLayers:function(){this.model.get("layers");n.prototype.initLayers.apply(this,arguments);var t=s(this.layersControl.getContainer()).find('[type="radio"],[type="checkbox"]'),e=this.$zoom().attr("name").replace("[zoom]","[layers][]");return t.each(function(t,n){var i=s(n);s(n).attr("name",e).attr("value",i.next().text().trim())}),this},bindInputListener:function(){var n=this;this.$lat().on("change",function(t){n.model.set("lat",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()}),this.$lng().on("change",function(t){n.model.set("lng",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()}),this.$zoom().on("change",function(t){n.model.set("zoom",s(t.target).val()),n.update_map()}).on("focus",function(t){n.unbindMapListener()}).on("blur",function(t){n.bindMapListener()})},bindMapListener:function(){this.listenTo(this.model,"change:lat",this.updateInput),this.listenTo(this.model,"change:lng",this.updateInput),this.listenTo(this.model,"change:zoom",this.updateInput)},bindListener:function(){var e=this;this.$returnFormat().on("change",function(t){var n=e.$el.data("editor-config"),i=e.model.get("layers");e.resetLayers(),"osm"===s(t.target).val()?n.restrict_providers=Object.values(a.options.osm_layers):n.restrict_providers=Object.values(a.options.leaflet_layers),e.$el.data("editor-config",n),e.model.set("layers",i),e.initLayers()})},unbindInputListener:function(){this.$lat().off("change").off("focus").off("blur"),this.$lng().off("change").off("focus").off("blur"),this.$zoom().off("change").off("focus").off("blur")},unbindMapListener:function(){this.stopListening(this.model,"change:lat",this.updateInput),this.stopListening(this.model,"change:lng",this.updateInput),this.stopListening(this.model,"change:zoom",this.updateInput)},update_visible:function(){var t=this.visible;n.prototype.update_visible.apply(this,arguments),t!==this.visible&&(this.visible?this.bindInputListener():this.unbindInputListener())}})}(jQuery,acf_osm_admin);