!function(s,a){var t=window.osm;var e=t.Field;t.Field=e.extend({$lat:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-center_lat"]')},$lng:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-center_lng"]')},$zoom:function(){return this.$el.closest(".acf-field-settings").find('input[id$="-zoom"]')},$returnFormat:function(){return this.$el.closest(".acf-field-settings").find('[data-name="return_format"]')},getMapData:function(){return{center_lat:parseFloat(this.$lat().val())||this.$el.data().mapLat,center_lng:parseFloat(this.$lng().val())||this.$el.data().mapLng,zoom:parseInt(this.$zoom().val())||this.$el.data().mapZoom,layers:this.$el.data().mapLayers}},initialize:function(t){e.prototype.initialize.apply(this,arguments),this.bindMapListener(),this.bindListener()},updateInput:function(){this.$lat().val(this.model.get("center_lat").toFixed(6)),this.$lng().val(this.model.get("center_lng").toFixed(6)),this.$zoom().val(this.model.get("zoom"))},initLayers:function(){this.model.get("layers");e.prototype.initLayers.apply(this,arguments);var t=s(this.layersControl.getContainer()).find('[type="radio"],[type="checkbox"]'),i=this.$zoom().attr("name").replace("[zoom]","[layers][]");return t.each(function(t,e){var n=s(e);s(e).attr("name",i).attr("value",n.next().text().trim())}),this},bindInputListener:function(){var e=this;this.$lat().on("change",function(t){e.model.set("center_lat",parseFloat(s(t.target).val())),e.update_map()}).on("focus",function(t){e.unbindMapListener()}).on("blur",function(t){e.bindMapListener()}),this.$lng().on("change",function(t){e.model.set("center_lng",parseFloat(s(t.target).val())),e.update_map()}).on("focus",function(t){e.unbindMapListener()}).on("blur",function(t){e.bindMapListener()}),this.$zoom().on("change",function(t){e.model.set("zoom",parseInt(s(t.target).val())),e.update_map()}).on("focus",function(t){e.unbindMapListener()}).on("blur",function(t){e.bindMapListener()})},bindMapListener:function(){this.listenTo(this.model,"change:center_lat",this.updateInput),this.listenTo(this.model,"change:center_lng",this.updateInput),this.listenTo(this.model,"change:zoom",this.updateInput)},bindListener:function(){var i=this;this.$returnFormat().on("change",function(t){var e=i.$el.data("editor-config"),n=i.model.get("layers");i.resetLayers(),"osm"===s(t.target).val()?e.restrict_providers=Object.values(a.options.osm_layers):e.restrict_providers=Object.values(a.options.leaflet_layers),i.$el.data("editor-config",e),i.model.set("layers",n),i.initLayers()})},unbindInputListener:function(){this.$lat().off("change").off("focus").off("blur"),this.$lng().off("change").off("focus").off("blur"),this.$zoom().off("change").off("focus").off("blur")},unbindMapListener:function(){this.stopListening(this.model,"change:center_lat",this.updateInput),this.stopListening(this.model,"change:center_lng",this.updateInput),this.stopListening(this.model,"change:zoom",this.updateInput)},update_visible:function(){var t=this.visible;e.prototype.update_visible.apply(this,arguments),t!==this.visible&&(this.visible?this.bindInputListener():this.unbindInputListener())}})}(jQuery,acf_osm_admin);