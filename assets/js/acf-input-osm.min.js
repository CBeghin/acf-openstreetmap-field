!function(t){var e=acf_osm.options;console.log("sefsef");var s={};s.field=Backbone.View.extend({$map:null,$zoom:null,$lat:null,$lng:null,$address:null,$tiles:null,marker:null,icon:null,map:null,layers:[],events:{'keyup [data-prop="address"]':"search",'focus [data-prop="address"]':"search","click .osm-result":"click_result","keyup .osm-result":"keyup_result","focus .osm-result":"focus_result"},initialize:function(){this.$map=this.$el.find(".acf-osm-map"),this.$zoom=this.$el.find('[data-prop="zoom"]'),this.$lat=this.$el.find('[data-prop="center_lat"]'),this.$lng=this.$el.find('[data-prop="center_lng"]'),this.$layers=this.$el.find('[data-prop="map_layers"]'),this.$address=this.$el.find('[data-prop="address"]'),this.$results=this.$address.next(".osm-results"),this.icon=L.divIcon({className:"osm-marker",html:"",iconSize:0}),this.map=L.map(this.$map.get(0),{scrollWheelZoom:!1,center:[this.$lat.val(),this.$lng.val()],zoom:this.$zoom.val()}),this.marker=L.marker([this.$lat.val(),this.$lng.val()],{icon:this.icon,title:this.$address.val()}).addTo(this.map),this.layers=[],this.$layers.is("select")&&acf.select2.init(this.$layers,{multiple:!0,ui:!0,allow_null:!1,ajax:!1},this.$el),this.bind_events(),this.update_layers()},bind_events:function(){var t=this;this.listenTo(this.$tiles,"change",this.update_layers),this.map.on("zoomend",function(e){t.map_zoomed.apply(t,[e])}),this.map.on("moveend",function(e){t.map_moved.apply(t,[e])}),this.map.on("click",function(e){t.map_clicked.apply(t,[e])})},map_moved:function(t){var e=this.map.getCenter();this.$lat.val(e.lat),this.$lng.val(e.lng)},map_zoomed:function(t){this.$zoom.val(this.map.getZoom())},map_clicked:function(t){var e=t.latlng;this.fetch_results("https://photon.komoot.de/reverse",{lon:e.lng,lat:e.lat},function(t){var s,a=0,i=t.features.length;for(a;a<i;a++){s=this.format_result(t.features[a]),this.marker.title=s,this.set_marker(e);break}}),this.set_marker(t.latlng)},set_marker:function(e){t(this.marker._icon).attr("title",this.marker.title),this.marker.setLatLng(e)},update_layers:function(){var s,a,i,r,l=[];if(null!==l){for(this.$layers.each(function(){var e=t(this).val();Array.isArray(l)?l=l.concat(e):l.push(e)});this.layers.length;)this.map.removeLayer(this.layers.pop());for(r=l.length,i=0;i<r;i++)s=l[i],a=e.layer_config[s.split(".")[0]]||{},this.layers.push(L.tileLayer.provider(s,a).addTo(this.map))}},search:function(t){var e=this,s={};if(void 0!==this._wait_address&&(clearTimeout(this._wait_address),delete this._wait_address),!s.g||s.g!==this.$address.val())return 27==t.originalEvent.keyCode?(t.preventDefault(),this.$results.html(""),this.$address.blur(),!1):void(this._wait_address=setTimeout(function(){s={q:e.$address.val(),limit:5,lon:e.$lng.val(),lat:e.$lat.val()},e.fetch_results("https://photon.komoot.de/api/",s,function(t){delete this._wait_address})},666))},clear_results:function(){this.$results.html("")},build_results:function(e){var s=this,a=e.features.length,i=this.$address.val(),r=e.features;this.clear_results(),a&&t.each(r,function(e,a){var r=t('<div tabindex="'+e+'" class="osm-result"></div>'),l=s.format_result(a),n=l.replace(new RegExp("("+i.split(/[^a-z0-9]/).join("|")+")","gi"),"<strong>$1</strong>");n+="<br /><small>("+s.nice_words(a.properties.osm_value)+")</small>",r.data({text:l,bounds:a.properties.extent,coord:a.geometry.coordinates}).html(n).appendTo(s.$results)})},fetch_results:function(e,s,a){var i=this;t.ajax({url:e,method:"get",data:s,success:function(t){i.build_results(t),"function"==typeof a&&a.apply(i,[t])}})},click_result:function(e){var s=t(e.target).data(),a=L.latLng(s.coord[1],s.coord[0]);s.ext?this.map.fitBounds(L.latLngBounds(L.latLng(s.ext[1],s.ext[0]),L.latLng(s.ext[3],s.ext[2]))):this.map.setView(a,this.map.getZoom()),this.$address.val(s.text),this.clear_results(),this.marker.title=s.text,this.set_marker(a)},keyup_result:function(e){40==e.originalEvent.keyCode?(t(e.target).next(".osm-result").focus(),e.preventDefault()):38==e.originalEvent.keyCode&&(t(e.target).prev(".osm-result").focus(),e.preventDefault())},focus_result:function(e){var s=t(e.target).data();s.ext?this.map.fitBounds(L.latLngBounds(L.latLng(s.ext[1],s.ext[0]),L.latLng(s.ext[3],s.ext[2]))):this.map.setView(L.latLng(s.coord[1],s.coord[0]),this.map.getZoom())},format_result:function(t){return this.get_result_words(t).join(", ")},get_result_words:function(e){var s=[],a=["name","street","housenumber","city","postcode","state","country"];return t.each(a,function(t,a){try{e.properties[a]&&s.push(e.properties[a])}catch(t){}}),Array.from(new Set(s))},nice_words:function(t){return t.split(/[\s_]/).map(function(t){return t[0].toUpperCase()+t.substring(1)}).join(" ")}}),void 0!==acf.add_action?acf.add_action("ready append",function(t){acf.get_fields({type:"open_street_map"},t).each(function(){new s.field({el:this})})}):t(document).on("acf/setup_fields",function(e,a){t(a).find('.field[data-field_type="open_street_map"]').each(function(){new s.field({el:this})})})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZi1pbnB1dC1vc20uanMiXSwibmFtZXMiOlsiJCIsIm9wdGlvbnMiLCJhY2Zfb3NtIiwiY29uc29sZSIsImxvZyIsIm9zbSIsImZpZWxkIiwiQmFja2JvbmUiLCJWaWV3IiwiZXh0ZW5kIiwiJG1hcCIsIiR6b29tIiwiJGxhdCIsIiRsbmciLCIkYWRkcmVzcyIsIiR0aWxlcyIsIm1hcmtlciIsImljb24iLCJtYXAiLCJsYXllcnMiLCJldmVudHMiLCJrZXl1cCBbZGF0YS1wcm9wPVwiYWRkcmVzc1wiXSIsImZvY3VzIFtkYXRhLXByb3A9XCJhZGRyZXNzXCJdIiwiY2xpY2sgLm9zbS1yZXN1bHQiLCJrZXl1cCAub3NtLXJlc3VsdCIsImZvY3VzIC5vc20tcmVzdWx0IiwiaW5pdGlhbGl6ZSIsInRoaXMiLCIkZWwiLCJmaW5kIiwiJGxheWVycyIsIiRyZXN1bHRzIiwibmV4dCIsIkwiLCJkaXZJY29uIiwiY2xhc3NOYW1lIiwiaHRtbCIsImljb25TaXplIiwiZ2V0Iiwic2Nyb2xsV2hlZWxab29tIiwiY2VudGVyIiwidmFsIiwiem9vbSIsInRpdGxlIiwiYWRkVG8iLCJpcyIsImFjZiIsInNlbGVjdDIiLCJpbml0IiwibXVsdGlwbGUiLCJ1aSIsImFsbG93X251bGwiLCJhamF4IiwiYmluZF9ldmVudHMiLCJ1cGRhdGVfbGF5ZXJzIiwic2VsZiIsImxpc3RlblRvIiwib24iLCJlIiwibWFwX3pvb21lZCIsImFwcGx5IiwibWFwX21vdmVkIiwibWFwX2NsaWNrZWQiLCJnZXRDZW50ZXIiLCJsYXQiLCJsbmciLCJnZXRab29tIiwiY29vcmQiLCJsYXRsbmciLCJmZXRjaF9yZXN1bHRzIiwibG9uIiwicmVzcG9uc2UiLCJmbXQiLCJpIiwibGVuIiwiZmVhdHVyZXMiLCJsZW5ndGgiLCJmb3JtYXRfcmVzdWx0Iiwic2V0X21hcmtlciIsIl9pY29uIiwiYXR0ciIsInNldExhdExuZyIsInByb3ZpZGVyIiwibGF5ZXJfY29uZmlnIiwiZWFjaCIsInYiLCJBcnJheSIsImlzQXJyYXkiLCJjb25jYXQiLCJwdXNoIiwicmVtb3ZlTGF5ZXIiLCJwb3AiLCJzcGxpdCIsInRpbGVMYXllciIsInNlYXJjaCIsImRhdGEiLCJfd2FpdF9hZGRyZXNzIiwiY2xlYXJUaW1lb3V0Iiwib3JpZ2luYWxFdmVudCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsImJsdXIiLCJzZXRUaW1lb3V0IiwicSIsImxpbWl0IiwiY2xlYXJfcmVzdWx0cyIsImJ1aWxkX3Jlc3VsdHMiLCJmZWF0IiwiZWwiLCIkcmVzIiwicmVwbGFjZSIsIlJlZ0V4cCIsImpvaW4iLCJuaWNlX3dvcmRzIiwicHJvcGVydGllcyIsIm9zbV92YWx1ZSIsInRleHQiLCJib3VuZHMiLCJleHRlbnQiLCJnZW9tZXRyeSIsImNvb3JkaW5hdGVzIiwiYXBwZW5kVG8iLCJ1cmwiLCJjYWxsYmFjayIsIm1ldGhvZCIsInN1Y2Nlc3MiLCJjbGlja19yZXN1bHQiLCJ0YXJnZXQiLCJsYXRMbmciLCJleHQiLCJmaXRCb3VuZHMiLCJsYXRMbmdCb3VuZHMiLCJzZXRWaWV3Iiwia2V5dXBfcmVzdWx0IiwiZm9jdXMiLCJwcmV2IiwiZm9jdXNfcmVzdWx0IiwiaGl0IiwiZ2V0X3Jlc3VsdF93b3JkcyIsImgiLCJwcm9wcyIsInByb3AiLCJlcnIiLCJmcm9tIiwiU2V0Iiwic3RyIiwicyIsInRvVXBwZXJDYXNlIiwic3Vic3RyaW5nIiwiYWRkX2FjdGlvbiIsImdldF9maWVsZHMiLCJ0eXBlIiwiZG9jdW1lbnQiLCJwb3N0Ym94IiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFVQSxHQUNULElBQUlDLEVBQVVDLFFBQVFELFFBQ3RCRSxRQUFRQyxJQUFJLFVBRVosSUFBSUMsS0FFSkEsRUFBSUMsTUFBUUMsU0FBU0MsS0FBS0MsUUFDekJDLEtBQU0sS0FDTkMsTUFBTyxLQUNQQyxLQUFNLEtBQ05DLEtBQU0sS0FDTkMsU0FBVSxLQUNWQyxPQUFRLEtBQ1JDLE9BQVEsS0FDUkMsS0FBSyxLQUNMQyxJQUFLLEtBQ0xDLFVB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LEtBRTNCMUIsV0FBWSxTQUFTZ0MsR0FDcEIsT0FBT0EsRUFBSXJELE1BQU0sU0FBUzFFLElBQUksU0FBU2dJLEdBQUksT0FBT0EsRUFBRSxHQUFHQyxjQUFnQkQsRUFBRUUsVUFBVSxLQUFPcEMsS0FBSyxhQU1uRSxJQUFuQmxFLElBQUl1RyxXQWdCZHZHLElBQUl1RyxXQUFXLGVBQWdCLFNBQVV6SCxHQUd4Q2tCLElBQUl3RyxZQUFhQyxLQUFPLG1CQUFvQjNILEdBQUt3RCxLQUFLLFdBRXJELElBQUkvRSxFQUFJQyxPQUFTc0csR0FBSWpGLFdBeUJ2QjNCLEVBQUV3SixVQUFVL0YsR0FBRyxtQkFBb0IsU0FBU0MsRUFBRytGLEdBRTlDekosRUFBRXlKLEdBQVM1SCxLQUFLLDZDQUE2Q3VELEtBQUssV0FFakUsSUFBSS9FLEVBQUlDLE9BQVNzRyxHQUFJakYsV0FoVnpCLENBMFZHK0giLCJmaWxlIjoiYWNmLWlucHV0LW9zbS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCl7XG5cdHZhciBvcHRpb25zID0gYWNmX29zbS5vcHRpb25zO1xuXHRjb25zb2xlLmxvZygnc2Vmc2VmJylcblxuXHR2YXIgb3NtID0ge1xuXHR9O1xuXHRvc20uZmllbGQgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cdFx0JG1hcDogbnVsbCxcblx0XHQkem9vbTogbnVsbCxcblx0XHQkbGF0OiBudWxsLFxuXHRcdCRsbmc6IG51bGwsXG5cdFx0JGFkZHJlc3M6IG51bGwsXG5cdFx0JHRpbGVzOiBudWxsLFxuXHRcdG1hcmtlcjogbnVsbCxcblx0XHRpY29uOm51bGwsXG5cdFx0bWFwOiBudWxsLFxuXHRcdGxheWVyczpbXSxcblx0XHRldmVudHM6e1xuXHRcdFx0J2tleXVwIFtkYXRhLXByb3A9XCJhZGRyZXNzXCJdJyA6ICdzZWFyY2gnLFxuXHRcdFx0J2ZvY3VzIFtkYXRhLXByb3A9XCJhZGRyZXNzXCJdJyA6ICdzZWFyY2gnLFxuXG5cdFx0XHQnY2xpY2sgLm9zbS1yZXN1bHQnXHQ6ICdjbGlja19yZXN1bHQnLFxuXHRcdFx0J2tleXVwIC5vc20tcmVzdWx0J1x0OiAna2V5dXBfcmVzdWx0Jyxcblx0XHRcdCdmb2N1cyAub3NtLXJlc3VsdCdcdDogJ2ZvY3VzX3Jlc3VsdCcsXG5cdFx0fSxcblx0XHRpbml0aWFsaXplOmZ1bmN0aW9uKCkge1xuXHRcdC8vXHR0aGlzLiRlbFx0XHQ9IHRoaXMuYXR0cmlidXRlcy4kZWw7XG5cdFx0XHR0aGlzLiRtYXBcdFx0PSB0aGlzLiRlbC5maW5kKCcuYWNmLW9zbS1tYXAnKTtcblx0XHRcdHRoaXMuJHpvb21cdFx0PSB0aGlzLiRlbC5maW5kKCdbZGF0YS1wcm9wPVwiem9vbVwiXScpO1xuXHRcdFx0dGhpcy4kbGF0XHRcdD0gdGhpcy4kZWwuZmluZCgnW2RhdGEtcHJvcD1cImNlbnRlcl9sYXRcIl0nKTtcblx0XHRcdHRoaXMuJGxuZ1x0XHQ9IHRoaXMuJGVsLmZpbmQoJ1tkYXRhLXByb3A9XCJjZW50ZXJfbG5nXCJdJyk7XG5cdFx0XHR0aGlzLiRsYXllcnNcdD0gdGhpcy4kZWwuZmluZCgnW2RhdGEtcHJvcD1cIm1hcF9sYXllcnNcIl0nKTtcblx0XHRcdHRoaXMuJGFkZHJlc3NcdD0gdGhpcy4kZWwuZmluZCgnW2RhdGEtcHJvcD1cImFkZHJlc3NcIl0nKTtcblx0XHRcdHRoaXMuJHJlc3VsdHNcdD0gdGhpcy4kYWRkcmVzcy5uZXh0KCcub3NtLXJlc3VsdHMnKTtcblx0XHRcdHRoaXMuaWNvblx0XHQ9IEwuZGl2SWNvbiggeyBjbGFzc05hbWU6ICdvc20tbWFya2VyJywgaHRtbDonJywgaWNvblNpemU6MCB9ICk7XG5cdFx0XHR0aGlzLm1hcFx0XHQ9IEwubWFwKCB0aGlzLiRtYXAuZ2V0KDApLCB7XG5cdFx0XHRcdHNjcm9sbFdoZWVsWm9vbTogZmFsc2UsXG5cdFx0XHRcdGNlbnRlcjogWyB0aGlzLiRsYXQudmFsKCksIHRoaXMuJGxuZy52YWwoKSBdLFxuXHRcdFx0XHR6b29tOiB0aGlzLiR6b29tLnZhbCgpXG5cdFx0XHR9ICk7XG5cdFx0XHR0aGlzLm1hcmtlclx0XHQ9IEwubWFya2VyKFxuXHRcdFx0XHRbIHRoaXMuJGxhdC52YWwoKSwgdGhpcy4kbG5nLnZhbCgpIF0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpY29uOnRoaXMuaWNvbixcblx0XHRcdFx0XHR0aXRsZTp0aGlzLiRhZGRyZXNzLnZhbCgpXG5cdFx0XHRcdH1cblx0XHRcdCkuYWRkVG8odGhpcy5tYXApO1xuXG5cdFx0XHR0aGlzLmxheWVyc1x0PSBbXTtcblx0XHRcdGlmICggdGhpcy4kbGF5ZXJzLmlzKCdzZWxlY3QnKSApIHtcblx0XHRcdFx0YWNmLnNlbGVjdDIuaW5pdCggdGhpcy4kbGF5ZXJzLCB7XG5cdFx0XHRcdFx0bXVsdGlwbGU6IHRydWUsXG5cdFx0XHRcdFx0dWk6IHRydWUsXG5cdFx0XHRcdFx0YWxsb3dfbnVsbDogZmFsc2UsXG5cdFx0XHRcdFx0YWpheDpmYWxzZSxcblx0XHRcdFx0fSwgdGhpcy4kZWwgKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5iaW5kX2V2ZW50cygpO1xuXG5cdFx0XHR0aGlzLnVwZGF0ZV9sYXllcnMoKTtcblx0XHR9LFxuXHRcdGJpbmRfZXZlbnRzOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblxuLy9cdFx0XHR0aGlzLmxpc3RlblRvKCB0aGlzLiRhZGRyZXNzLCAna2V5dXAgZm9jdXMnLCB0aGlzLnNlYXJjaCApO1xuXG5cdFx0XHR0aGlzLmxpc3RlblRvKCB0aGlzLiR0aWxlcywgJ2NoYW5nZScsIHRoaXMudXBkYXRlX2xheWVycyApO1xuXG5cdFx0XHR0aGlzLm1hcC5vbignem9vbWVuZCcsIGZ1bmN0aW9uKGUpeyBzZWxmLm1hcF96b29tZWQuYXBwbHkoc2VsZixbZV0pOyB9ICk7XG5cdFx0XHR0aGlzLm1hcC5vbignbW92ZWVuZCcsIGZ1bmN0aW9uKGUpeyBzZWxmLm1hcF9tb3ZlZC5hcHBseShzZWxmLFtlXSk7IH0gICk7XG5cdFx0XHR0aGlzLm1hcC5vbignY2xpY2snLCAgIGZ1bmN0aW9uKGUpeyBzZWxmLm1hcF9jbGlja2VkLmFwcGx5KHNlbGYsW2VdKTsgfSApO1xuXG5cdFx0XHQvLyB0aGlzLiR0aWxlcy5vbignY2hhbmdlJywgZG9fbGF5ZXJzIClcblx0XHRcdC8vIFx0LnByZXYoJ2lucHV0Jykub24oJ2NoYW5nZScsIGRvX2xheWVycyApO1xuXG5cdFx0fSxcblxuXHRcdG1hcF9tb3ZlZDpmdW5jdGlvbihlKXtcblx0XHRcdHZhciBjZW50ZXIgPSB0aGlzLm1hcC5nZXRDZW50ZXIoKTtcblx0XHRcdHRoaXMuJGxhdC52YWwoY2VudGVyLmxhdCk7XG5cdFx0XHR0aGlzLiRsbmcudmFsKGNlbnRlci5sbmcpO1xuXHRcdH0sXG5cdFx0bWFwX3pvb21lZDpmdW5jdGlvbihlKXtcblx0XHRcdHRoaXMuJHpvb20udmFsKCB0aGlzLm1hcC5nZXRab29tKCkgKTtcblx0XHR9LFxuXHRcdG1hcF9jbGlja2VkOmZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGNvb3JkID0gZS5sYXRsbmc7XG5cblx0XHRcdHRoaXMuZmV0Y2hfcmVzdWx0cygnaHR0cHM6Ly9waG90b24ua29tb290LmRlL3JldmVyc2UnLCB7XG5cdFx0XHRcdGxvbjpjb29yZC5sbmcsXG5cdFx0XHRcdGxhdDpjb29yZC5sYXQsXG5cdFx0XHR9LCBmdW5jdGlvbihyZXNwb25zZSl7XG5cdFx0XHRcdHZhciBpPTAsbGVuPXJlc3BvbnNlLmZlYXR1cmVzLmxlbmd0aCxmbXQ7XG5cdFx0XHRcdGZvciAoaTtpPGxlbjtpKyspe1xuXHRcdFx0XHRcdGZtdCA9IHRoaXMuZm9ybWF0X3Jlc3VsdCggcmVzcG9uc2UuZmVhdHVyZXNbaV0gKTtcblx0XHRcdFx0XHR0aGlzLm1hcmtlci50aXRsZSA9IGZtdDtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdHRoaXMuc2V0X21hcmtlciggTC5sYXRMbmcoIHJlc3BvbnNlLmZlYXR1cmVzW2ldLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzFdLCByZXNwb25zZS5mZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSApICApO1xuXHRcdFx0XHRcdC8qL1xuXHRcdFx0XHRcdHRoaXMuc2V0X21hcmtlciggY29vcmQgKTtcblx0XHRcdFx0XHQvLyovXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHRcdHRoaXMuc2V0X21hcmtlciggZS5sYXRsbmcgKTtcblx0XHR9LFxuXHRcdHNldF9tYXJrZXI6ZnVuY3Rpb24oY29vcmQpe1xuXG5cdFx0XHQkKHRoaXMubWFya2VyLl9pY29uKS5hdHRyKCAndGl0bGUnLCB0aGlzLm1hcmtlci50aXRsZSApO1xuXHRcdFx0dGhpcy5tYXJrZXIuc2V0TGF0TG5nKGNvb3JkKTtcblx0XHR9LFxuXG5cdFx0dXBkYXRlX2xheWVyczogZnVuY3Rpb24oKXtcblx0XHRcdHZhciB2YWwgPSBbXSxcblx0XHRcdFx0cHJvdmlkZXIsIGxheWVyX2NvbmZpZywgaSwgbGVuO1xuXG5cdFx0XHRpZiAoIG51bGwgPT09IHZhbCApIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy4kbGF5ZXJzLmVhY2goZnVuY3Rpb24oKXtcblx0XHRcdFx0dmFyIHYgPSAkKHRoaXMpLnZhbCgpO1xuXHRcdFx0XHRpZiAoIEFycmF5LmlzQXJyYXkodmFsKSApIHtcblx0XHRcdFx0XHR2YWwgPSB2YWwuY29uY2F0KHYpXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFsLnB1c2godilcblx0XHRcdFx0fVxuXG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGxheWVyc1xuXHRcdFx0d2hpbGUgKCB0aGlzLmxheWVycy5sZW5ndGggKSB7XG5cdFx0XHRcdHRoaXMubWFwLnJlbW92ZUxheWVyKCB0aGlzLmxheWVycy5wb3AoKSApO1xuXHRcdFx0fVxuXG5cdFx0XHRsZW4gPSB2YWwubGVuZ3RoO1xuXG5cdFx0XHRmb3IgKCBpPTA7aTxsZW47aSsrICkge1xuXHRcdFx0XHRwcm92aWRlciA9IHZhbFtpXTtcblx0XHRcdFx0bGF5ZXJfY29uZmlnID0gb3B0aW9ucy5sYXllcl9jb25maWdbIHByb3ZpZGVyLnNwbGl0KCcuJylbMF0gXSB8fCB7fTtcblx0XHRcdFx0dGhpcy5sYXllcnMucHVzaCggTC50aWxlTGF5ZXIucHJvdmlkZXIoIHByb3ZpZGVyLCBsYXllcl9jb25maWcgKS5hZGRUbyh0aGlzLm1hcCkgKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlYXJjaDpmdW5jdGlvbihlKXtcblx0XHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdFx0ZGF0YSA9IHt9O1xuXHRcdFx0aWYgKCAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHRoaXMuX3dhaXRfYWRkcmVzcyApIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuX3dhaXRfYWRkcmVzcyk7XG5cdFx0XHRcdGRlbGV0ZSB0aGlzLl93YWl0X2FkZHJlc3M7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghISBkYXRhWydnJ10gJiYgZGF0YVsnZyddID09PSB0aGlzLiRhZGRyZXNzLnZhbCgpICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmICggMjcgPT0gZS5vcmlnaW5hbEV2ZW50LmtleUNvZGUgKSB7IC8vIGVzY1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHRoaXMuJHJlc3VsdHMuaHRtbCgnJyk7XG5cdFx0XHRcdHRoaXMuJGFkZHJlc3MuYmx1cigpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl93YWl0X2FkZHJlc3MgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpe1xuXHRcdFx0XHRkYXRhID0ge1xuXHRcdFx0XHRcdHE6c2VsZi4kYWRkcmVzcy52YWwoKSxcbi8vXHRcdFx0XHRcdFx0bGFuZzonZGUnLCAtwrQvLyAtPiBXUC1MYW5nIVxuXHRcdFx0XHRcdGxpbWl0OjUsXG5cdFx0XHRcdFx0bG9uOnNlbGYuJGxuZy52YWwoKSxcblx0XHRcdFx0XHRsYXQ6c2VsZi4kbGF0LnZhbCgpLFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRzZWxmLmZldGNoX3Jlc3VsdHMoJ2h0dHBzOi8vcGhvdG9uLmtvbW9vdC5kZS9hcGkvJyxkYXRhLCBmdW5jdGlvbihyZXNwb25zZSl7XG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuX3dhaXRfYWRkcmVzcztcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCA2NjYgKTtcblxuXHRcdH0sXG5cdFx0Y2xlYXJfcmVzdWx0czpmdW5jdGlvbigpe1xuXHRcdFx0dGhpcy4kcmVzdWx0cy5odG1sKCcnKTtcblx0XHR9LFxuXHRcdGJ1aWxkX3Jlc3VsdHM6ZnVuY3Rpb24ocmVzcG9uc2Upe1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHRpPTAsIGxlbiA9IHJlc3BvbnNlLmZlYXR1cmVzLmxlbmd0aCxcblx0XHRcdFx0cSA9IHRoaXMuJGFkZHJlc3MudmFsKCksXG5cdFx0XHRcdGZlYXQgPSByZXNwb25zZS5mZWF0dXJlczsvL3NvcnRfZnV6enkoIHJlc3BvbnNlLmZlYXR1cmVzLCBxICk7XG5cblx0XHRcdHRoaXMuY2xlYXJfcmVzdWx0cygpO1xuXG5cdFx0XHRpZiAoIGxlbiApIHtcblx0XHRcdFx0JC5lYWNoKCBmZWF0LCBmdW5jdGlvbihpLGVsKXtcblx0XHRcdFx0XHR2YXIgJHJlcyA9ICQoJzxkaXYgdGFiaW5kZXg9XCInK2krJ1wiIGNsYXNzPVwib3NtLXJlc3VsdFwiPjwvZGl2PicpLFxuXHRcdFx0XHRcdFx0Ly8gY29vcmQgPSBlbC5nZW9tZXRyeS5jb29yZGluYXRlcyxcblx0XHRcdFx0XHRcdC8vIGV4dCA9IGVsLnByb3BlcnRpZXMuZXh0ZW50LFxuXHRcdFx0XHRcdFx0Zm10ID0gc2VsZi5mb3JtYXRfcmVzdWx0KCBlbCApLFxuXHRcdFx0XHRcdFx0aHRtbCA9IGZtdC5yZXBsYWNlKCBuZXcgUmVnRXhwKFwiKFwiK3Euc3BsaXQoL1teYS16MC05XS8pLmpvaW4oJ3wnKStcIilcIiwnZ2knKSxcIjxzdHJvbmc+JDE8L3N0cm9uZz5cIik7XG5cdFx0XHRcdFx0aHRtbCArPSAnPGJyIC8+PHNtYWxsPignICsgc2VsZi5uaWNlX3dvcmRzKCBlbC5wcm9wZXJ0aWVzLm9zbV92YWx1ZSApICsgJyk8L3NtYWxsPic7XG5cblx0XHRcdFx0XHQkcmVzLmRhdGEoe1xuXHRcdFx0XHRcdFx0dGV4dDpmbXQsXG5cdFx0XHRcdFx0XHRib3VuZHM6ZWwucHJvcGVydGllcy5leHRlbnQsXG5cdFx0XHRcdFx0XHRjb29yZDplbC5nZW9tZXRyeS5jb29yZGluYXRlcyxcblx0XHRcdFx0XHR9KS5odG1sKCBodG1sICkuYXBwZW5kVG8oc2VsZi4kcmVzdWx0cyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0fSxcblx0XHRmZXRjaF9yZXN1bHRzOiBmdW5jdGlvbih1cmwsZGF0YSwgY2FsbGJhY2spIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdCQuYWpheCh7XG5cdFx0XHRcdHVybDp1cmwsXG5cdFx0XHRcdG1ldGhvZDonZ2V0Jyxcblx0XHRcdFx0ZGF0YTpkYXRhLFxuXHRcdFx0XHRzdWNjZXNzOmZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0c2VsZi5idWlsZF9yZXN1bHRzKHJlc3BvbnNlKTtcblx0XHRcdFx0XHQnZnVuY3Rpb24nID09PSB0eXBlb2YgY2FsbGJhY2sgJiYgY2FsbGJhY2suYXBwbHkoc2VsZixbcmVzcG9uc2VdKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9LFxuXG5cdFx0Y2xpY2tfcmVzdWx0OmZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGRhdGEgPSAkKGUudGFyZ2V0KS5kYXRhKCksXG5cdFx0XHRcdGxhdGxuZyA9IEwubGF0TG5nKCBkYXRhLmNvb3JkWzFdLCBkYXRhLmNvb3JkWzBdICk7XG5cblx0XHRcdGlmICggZGF0YS5leHQgKSB7XG5cblx0XHRcdFx0dGhpcy5tYXAuZml0Qm91bmRzKCBMLmxhdExuZ0JvdW5kcyhcblx0XHRcdFx0XHRMLmxhdExuZyggZGF0YS5leHRbMV0sIGRhdGEuZXh0WzBdICksXG5cdFx0XHRcdFx0TC5sYXRMbmcoIGRhdGEuZXh0WzNdLCBkYXRhLmV4dFsyXSApXG5cdFx0XHRcdCkgKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMubWFwLnNldFZpZXcoIGxhdGxuZywgdGhpcy5tYXAuZ2V0Wm9vbSgpICk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLiRhZGRyZXNzLnZhbCggZGF0YS50ZXh0ICk7XG5cdFx0XHR0aGlzLmNsZWFyX3Jlc3VsdHMoKTtcblxuXHRcdFx0dGhpcy5tYXJrZXIudGl0bGUgPSBkYXRhLnRleHQ7XG5cdFx0XHR0aGlzLnNldF9tYXJrZXIoIGxhdGxuZyApO1xuXHRcdH0sXG5cblx0XHRrZXl1cF9yZXN1bHQ6ZnVuY3Rpb24oZSl7XG5cdFx0XHRpZiAoZS5vcmlnaW5hbEV2ZW50LmtleUNvZGUgPT0gNDApIHsgLy8gZG93blxuXHRcdFx0XHQkKCBlLnRhcmdldCApLm5leHQoJy5vc20tcmVzdWx0JykuZm9jdXMoKTtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpXG5cdFx0XHR9IGVsc2UgaWYgKGUub3JpZ2luYWxFdmVudC5rZXlDb2RlID09IDM4KSB7XG5cdFx0XHRcdCQoIGUudGFyZ2V0ICkucHJldignLm9zbS1yZXN1bHQnKS5mb2N1cygpO1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KClcblx0XHRcdH1cblxuXHRcdH0sXG5cdFx0Zm9jdXNfcmVzdWx0OmZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGRhdGEgPSAkKGUudGFyZ2V0KS5kYXRhKCk7XG5cblx0XHRcdGlmICggZGF0YS5leHQgKSB7XG5cdFx0XHRcdHRoaXMubWFwLmZpdEJvdW5kcyggTC5sYXRMbmdCb3VuZHMoXG5cdFx0XHRcdFx0TC5sYXRMbmcoIGRhdGEuZXh0WzFdLCBkYXRhLmV4dFswXSApLFxuXHRcdFx0XHRcdEwubGF0TG5nKCBkYXRhLmV4dFszXSwgZGF0YS5leHRbMl0gKVxuXHRcdFx0XHQpICk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm1hcC5zZXRWaWV3KCBMLmxhdExuZyggZGF0YS5jb29yZFsxXSwgZGF0YS5jb29yZFswXSApLCB0aGlzLm1hcC5nZXRab29tKCkgKTtcblx0XHRcdH1cblxuXHRcdH0sXG5cblx0XHRmb3JtYXRfcmVzdWx0OiBmdW5jdGlvbiggaGl0ICkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0X3Jlc3VsdF93b3JkcyggaGl0ICkuam9pbignLCAnKTtcblx0XHR9LFxuXG5cdFx0Z2V0X3Jlc3VsdF93b3JkczogZnVuY3Rpb24oIGhpdCApIHtcblxuXHRcdFx0dmFyIGggPSBbXSxcblx0XHRcdFx0cHJvcHMgPSBbICduYW1lJywnc3RyZWV0JywnaG91c2VudW1iZXInLCdjaXR5JywncG9zdGNvZGUnLCdzdGF0ZScsJ2NvdW50cnknIF07XG5cdFx0XHQkLmVhY2gocHJvcHMsIGZ1bmN0aW9uKGkscHJvcCkge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGlmICggISEgaGl0LnByb3BlcnRpZXNbcHJvcF0gKSB7XG5cdFx0XHRcdFx0XHRoLnB1c2goaGl0LnByb3BlcnRpZXNbcHJvcF0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaChlcnIpe31cblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIEFycmF5LmZyb20obmV3IFNldChoKSk7XG5cdFx0fSxcblx0XHRuaWNlX3dvcmRzOiBmdW5jdGlvbihzdHIpIHtcblx0XHRcdHJldHVybiBzdHIuc3BsaXQoL1tcXHNfXS8pLm1hcChmdW5jdGlvbihzKXsgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc3Vic3RyaW5nKDEpOyB9KS5qb2luKCcgJyk7XG5cdFx0fVxuXG5cdH0pO1xuXG5cblx0aWYoIHR5cGVvZiBhY2YuYWRkX2FjdGlvbiAhPT0gJ3VuZGVmaW5lZCcgKSB7XG5cblx0XHQvKlxuXHRcdCogIHJlYWR5IGFwcGVuZCAoQUNGNSlcblx0XHQqXG5cdFx0KiAgVGhlc2UgYXJlIDIgZXZlbnRzIHdoaWNoIGFyZSBmaXJlZCBkdXJpbmcgdGhlIHBhZ2UgbG9hZFxuXHRcdCogIHJlYWR5ID0gb24gcGFnZSBsb2FkIHNpbWlsYXIgdG8gJChkb2N1bWVudCkucmVhZHkoKVxuXHRcdCogIGFwcGVuZCA9IG9uIG5ldyBET00gZWxlbWVudHMgYXBwZW5kZWQgdmlhIHJlcGVhdGVyIGZpZWxkXG5cdFx0KlxuXHRcdCogIEB0eXBlXHRldmVudFxuXHRcdCogIEBkYXRlXHQyMC8wNy8xM1xuXHRcdCpcblx0XHQqICBAcGFyYW1cdCRlbCAoalF1ZXJ5IHNlbGVjdGlvbikgdGhlIGpRdWVyeSBlbGVtZW50IHdoaWNoIGNvbnRhaW5zIHRoZSBBQ0YgZmllbGRzXG5cdFx0KiAgQHJldHVyblx0bi9hXG5cdFx0Ki9cblxuXHRcdGFjZi5hZGRfYWN0aW9uKCdyZWFkeSBhcHBlbmQnLCBmdW5jdGlvbiggJGVsICl7XG5cblx0XHRcdC8vIHNlYXJjaCAkZWwgZm9yIGZpZWxkcyBvZiB0eXBlICdGSUVMRF9OQU1FJ1xuXHRcdFx0YWNmLmdldF9maWVsZHMoeyB0eXBlIDogJ29wZW5fc3RyZWV0X21hcCd9LCAkZWwpLmVhY2goZnVuY3Rpb24oKXtcblxuXHRcdFx0XHRuZXcgb3NtLmZpZWxkKCB7IGVsOiB0aGlzIH0gKTtcblxuXHRcdFx0fSk7XG5cblx0XHR9KTtcblxuXG5cdH0gZWxzZSB7XG5cblxuXHRcdC8qXG5cdFx0KiAgYWNmL3NldHVwX2ZpZWxkcyAoQUNGNClcblx0XHQqXG5cdFx0KiAgVGhpcyBldmVudCBpcyB0cmlnZ2VyZWQgd2hlbiBBQ0YgYWRkcyBhbnkgbmV3IGVsZW1lbnRzIHRvIHRoZSBET00uXG5cdFx0KlxuXHRcdCogIEB0eXBlXHRmdW5jdGlvblxuXHRcdCogIEBzaW5jZVx0MS4wLjBcblx0XHQqICBAZGF0ZVx0MDEvMDEvMTJcblx0XHQqXG5cdFx0KiAgQHBhcmFtXHRldmVudFx0XHRlOiBhbiBldmVudCBvYmplY3QuIFRoaXMgY2FuIGJlIGlnbm9yZWRcblx0XHQqICBAcGFyYW1cdEVsZW1lbnRcdFx0cG9zdGJveDogQW4gZWxlbWVudCB3aGljaCBjb250YWlucyB0aGUgbmV3IEhUTUxcblx0XHQqXG5cdFx0KiAgQHJldHVyblx0bi9hXG5cdFx0Ki9cblxuXHRcdCQoZG9jdW1lbnQpLm9uKCdhY2Yvc2V0dXBfZmllbGRzJywgZnVuY3Rpb24oZSwgcG9zdGJveCl7XG5cblx0XHRcdCQocG9zdGJveCkuZmluZCgnLmZpZWxkW2RhdGEtZmllbGRfdHlwZT1cIm9wZW5fc3RyZWV0X21hcFwiXScpLmVhY2goZnVuY3Rpb24oKXtcblxuXHRcdFx0XHRuZXcgb3NtLmZpZWxkKCB7IGVsOiB0aGlzIH0gKTtcblxuXHRcdFx0fSk7XG5cblx0XHR9KTtcblxuXG5cdH1cblxuXG59KShqUXVlcnkpO1xuIl19
